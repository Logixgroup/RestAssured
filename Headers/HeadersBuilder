package com.framework.headers;

import java.util.HashMap;
import java.util.Map;

public class HeadersBuilder {

    private final Map<String, String> headers = new HashMap<>();

    public HeadersBuilder withContentType(String contentType) {
        headers.put(HeaderKeys.CONTENT_TYPE.value(), contentType);
        return this;
    }

    public HeadersBuilder withAccept(String acceptType) {
        headers.put(HeaderKeys.ACCEPT.value(), acceptType);
        return this;
    }

    public HeadersBuilder withAcceptLanguage(String lang) {
        headers.put(HeaderKeys.ACCEPT_LANGUAGE.value(), HeaderUtils.acceptLanguage(lang));
        return this;
    }

    public HeadersBuilder withUserAgent(String userAgent) {
        headers.put(HeaderKeys.USER_AGENT.value(), userAgent);
        return this;
    }

    // ⭐ Renamed — Bearer Authorization Header
    public HeadersBuilder withBearerAuthorisation(String token) {
        headers.put(HeaderKeys.AUTHORIZATION.value(), HeaderUtils.bearerAuthHeader(token));
        return this;
    }

    // ⭐ New — Add Bearer token with a separate header name (e.g., X-Auth-Token)
    public HeadersBuilder withBearerAuthorisationId(String headerKey, String token) {
        headers.put(headerKey, HeaderUtils.bearerAuthHeader(token));
        return this;
    }

    public HeadersBuilder withBasicAuthorisation(String user, String pass) {
        headers.put(HeaderKeys.AUTHORIZATION.value(), HeaderUtils.basicAuthHeader(user, pass));
        return this;
    }

    public HeadersBuilder withAccessKeyAuthorisation(String key, String secret) {
        headers.put(HeaderKeys.AUTHORIZATION.value(), HeaderUtils.accessKeyAuthHeader(key, secret));
        return this;
    }

    // ⭐ Renamed — Correlation id
    public HeadersBuilder withCorrelationId(String id) {
        headers.put(HeaderKeys.CORRELATION_ID.value(), id);
        return this;
    }

    // ⭐ Convenience method — auto-generate correlation ID
    public HeadersBuilder withGeneratedCorrelationId() {
        return withCorrelationId(HeaderUtils.generateTransactionId());
    }

    // ⭐ Custom Header
    public HeadersBuilder withCustomHeader(String key, String value) {
        headers.put(key, value);
        return this;
    }

    // ⭐ Remove header
    public HeadersBuilder remove(String key) {
        headers.remove(key);
        return this;
    }

    public HeadersBuilder remove(HeaderKeys key) {
        headers.remove(key.value());
        return this;
    }

    public Map<String, String> build() {
        return Map.copyOf(headers);
    }
}
