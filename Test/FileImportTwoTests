import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.ObjectNode;
import io.restassured.http.ContentType;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import java.util.Map;
import java.util.UUID;

public class  {

    private String fileImportUrl;
    private Map<String, String> headers;
    private ObjectMapper mapper;

    @BeforeClass
    public void init() {

        String baseUrl = "https://api.yourdomain.com";
        fileImportUrl = baseUrl + "/v1/file-import";

        String token = "Bearer " + "sampleTokenXYZ";

        headers = Map.of(
                "Authorization", token,
                "Content-Type", "application/json"
        );

        mapper = new ObjectMapper();
    }

    // ===================================================================
    // 1️⃣ FIRST TESTCASE — DIFFERENT DATA (Using Map Body)
    // ===================================================================

    @Test
    public void testFileImport_FirstDataSet() {

        String randomMember = UUID.randomUUID().toString().substring(0, 8);

        Map<String, Object> finalBody = Map.of(
                "fiId", "FI-11111",
                "memberNumber", randomMember,
                "fileType", "DOMESTIC",
                "description", "First dataset execution"
        );

        io.restassured.RestAssured
                .given()
                .headers(headers)
                .contentType(ContentType.APPLICATION_JSON.getMimeType())
                .body(finalBody)
        .when()
                .post(fileImportUrl)
        .then()
                .statusCode(200);
    }

    // ===================================================================
    // 2️⃣ SECOND TESTCASE — DIFFERENT DATA (Using ObjectNode)
    // ===================================================================

    @Test
    public void testFileImport_SecondDataSet() {

        String randomMember = UUID.randomUUID().toString().substring(0, 8);

        ObjectNode node = mapper.createObjectNode();
        node.put("fiId", "FI-22222");
        node.put("memberNumber", randomMember);
        node.put("fileType", "INTERNATIONAL");
        node.put("description", "Second dataset execution");

        Object finalBody = node;

        io.restassured.RestAssured
                .given()
                .headers(headers)
                .contentType(ContentType.APPLICATION_JSON.getMimeType())
                .body(finalBody)
        .when()
                .post(fileImportUrl)
        .then()
                .statusCode(200);
    }
}
